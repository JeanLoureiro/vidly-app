{"ast":null,"code":"import _toConsumableArray from \"/Users/tcc-jean/sites/study/react/vidly/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/tcc-jean/sites/study/react/vidly/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/tcc-jean/sites/study/react/vidly/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/tcc-jean/sites/study/react/vidly/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/tcc-jean/sites/study/react/vidly/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/tcc-jean/sites/study/react/vidly/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/tcc-jean/sites/study/react/vidly/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/tcc-jean/sites/study/react/vidly/src/components/movies.jsx\";\nimport React, { Component } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { getMovies, deleteMovie } from \"../services/fakeMovieService\";\nimport MoviesTable from './moviesTable';\nimport Pagination from \"./common/pagination\";\nimport ListGroup from \"./common/listGroup\";\nimport { paginate } from '../utils/paginate';\nimport { getGenres } from '../services/fakeGenreService';\nimport _ from 'lodash';\n\nvar Movies =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Movies, _Component);\n\n  function Movies() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Movies);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Movies)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      movies: [],\n      genres: [],\n      pageSize: 4,\n      currentPage: 1,\n      selectedGenre: '',\n      sortColumn: {\n        path: 'title',\n        order: 'asc'\n      }\n    };\n\n    _this.handleDelete = function (id) {\n      var deletedMovie = deleteMovie(id);\n\n      _this.setState({\n        movie: deletedMovie\n      });\n    };\n\n    _this.handleLike = function (id) {\n      var movies = _this.state.movies.map(function (movie) {\n        return movie._id === id ? _objectSpread({}, movie, {\n          liked: !movie.liked\n        }) : movie;\n      });\n\n      _this.setState({\n        movies: movies\n      });\n    };\n\n    _this.handlePageChange = function (page) {\n      _this.setState({\n        currentPage: page\n      });\n    };\n\n    _this.handleGenreSelect = function (genre) {\n      _this.setState({\n        selectedGenre: genre,\n        currentPage: 1\n      });\n    };\n\n    _this.handleSort = function (sortColumn) {\n      _this.setState({\n        sortColumn: sortColumn\n      });\n    };\n\n    _this.getPagedData = function () {\n      var _this$state = _this.state,\n          allMovies = _this$state.movies,\n          pageSize = _this$state.pageSize,\n          currentPage = _this$state.currentPage,\n          selectedGenre = _this$state.selectedGenre,\n          sortColumn = _this$state.sortColumn;\n      var filtered = selectedGenre && selectedGenre._id ? allMovies.filter(function (m) {\n        return m.genre._id === selectedGenre._id;\n      }) : allMovies;\n\n      var sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order]);\n\n      var movies = paginate(sorted, currentPage, pageSize);\n      return {\n        totalCount: filtered.length,\n        data: movies\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(Movies, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var genres = [{\n        _id: '',\n        name: 'All Genres'\n      }].concat(_toConsumableArray(getGenres()));\n      this.setState({\n        movies: getMovies(),\n        genres: genres\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          pageSize = _this$state2.pageSize,\n          currentPage = _this$state2.currentPage,\n          genres = _this$state2.genres,\n          selectedGenre = _this$state2.selectedGenre,\n          sortColumn = _this$state2.sortColumn;\n      if (this.state.movies.length === 0) return React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, \"There are no movies in the database\");\n\n      var _this$getPagedData = this.getPagedData(),\n          totalCount = _this$getPagedData.totalCount,\n          movies = _this$getPagedData.data;\n\n      return React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(ListGroup, {\n        items: genres,\n        selectedItem: selectedGenre,\n        onItemSelect: this.handleGenreSelect,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, React.createElement(NavLink, {\n        to: \"/movies/new\",\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, \" New Movie \"), React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, \"Showing \", totalCount, \" movies in the database.\"), React.createElement(MoviesTable, {\n        movies: movies,\n        sortColumn: sortColumn,\n        onDelete: this.handleDelete,\n        onLike: this.handleLike,\n        onSort: this.handleSort,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }), React.createElement(Pagination, {\n        itemsCount: totalCount,\n        pageSize: pageSize,\n        currentPage: currentPage,\n        onPageChange: this.handlePageChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Movies;\n}(Component);\n\nexport default Movies;","map":{"version":3,"sources":["/Users/tcc-jean/sites/study/react/vidly/src/components/movies.jsx"],"names":["React","Component","NavLink","getMovies","deleteMovie","MoviesTable","Pagination","ListGroup","paginate","getGenres","_","Movies","state","movies","genres","pageSize","currentPage","selectedGenre","sortColumn","path","order","handleDelete","id","deletedMovie","setState","movie","handleLike","map","_id","liked","handlePageChange","page","handleGenreSelect","genre","handleSort","getPagedData","allMovies","filtered","filter","m","sorted","orderBy","totalCount","length","data","name"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { NavLink } from 'react-router-dom'\nimport { getMovies, deleteMovie } from \"../services/fakeMovieService\";\nimport MoviesTable from './moviesTable'\nimport Pagination from \"./common/pagination\"\nimport ListGroup from \"./common/listGroup\"\nimport { paginate } from '../utils/paginate'\nimport { getGenres } from '../services/fakeGenreService';\nimport _ from 'lodash'\n\n\nclass Movies extends Component {\n    state = {\n        movies: [],\n        genres: [],\n        pageSize: 4,\n        currentPage: 1,\n        selectedGenre: '',\n        sortColumn: {\n            path: 'title',\n            order: 'asc'\n        }\n    }\n\n    componentDidMount() {\n        const genres = [ { _id: '' ,name: 'All Genres'}, ...getGenres() ]\n\n        this.setState({\n            movies: getMovies(),\n            genres\n        })\n    }\n\n    handleDelete = id => {\n        const deletedMovie = deleteMovie(id)\n\n        this.setState({\n            movie: deletedMovie\n        })\n    }\n\n    handleLike = id => {\n        const movies = this.state.movies.map(movie =>\n            movie._id === id\n                ? { ...movie, liked: !movie.liked }\n                : movie\n        )\n\n        this.setState({\n            movies\n        })\n    }\n\n    handlePageChange = page => {\n        this.setState({ currentPage: page })\n    }\n\n    handleGenreSelect = genre => {\n        this.setState({\n            selectedGenre: genre,\n            currentPage: 1\n        })\n    }\n\n    handleSort = sortColumn => {\n        this.setState({ sortColumn })\n    }\n\n    getPagedData = () => {\n\n        const { \n            movies: allMovies, \n            pageSize, \n            currentPage, \n            selectedGenre, \n            sortColumn \n        } = this.state\n\n        const filtered = selectedGenre && selectedGenre._id\n        ? allMovies.filter( m => m.genre._id === selectedGenre._id ) \n        : allMovies\n\n        const sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order])    \n\n        const movies = paginate(sorted, currentPage, pageSize)\n\n        return { totalCount: filtered.length, data: movies }\n    }\n\n    render() {\n\n        const { \n            pageSize, \n            currentPage, \n            genres, \n            selectedGenre, \n            sortColumn \n        } = this.state\n\n        if (this.state.movies.length === 0) return <h2>There are no movies in the database</h2>\n\n        const { totalCount, data: movies } = this.getPagedData()\n\n        return (\n            <div className='row'>\n                <div className=\"col-3\">\n                    <ListGroup \n                        items={genres} \n                        selectedItem={ selectedGenre }\n                        onItemSelect={this.handleGenreSelect}\n                        />\n                </div>\n                <div className=\"col\">\n                    <NavLink to='/movies/new' className='btn btn-primary'> New Movie </NavLink>\n                    <h2>Showing {totalCount} movies in the database.</h2>\n                    <MoviesTable \n                        movies={ movies } \n                        sortColumn={ sortColumn }\n                        onDelete={ this.handleDelete }    \n                        onLike={ this.handleLike }    \n                        onSort={ this.handleSort }\n                    />\n                    <Pagination\n                        itemsCount={totalCount}\n                        pageSize={pageSize}\n                        currentPage={currentPage}\n                        onPageChange={this.handlePageChange}\n                    />\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Movies;"]},"metadata":{},"sourceType":"module"}